# 魔法冰球玩法说明文档

## 游戏概述

魔法冰球是一款基于VR的双人对战竞技游戏，玩家通过手势控制护盾的元素属性，利用元素相克机制进行攻防，将球打进对方球门得分。

## 基本规则

### 对战模式
- **队伍配置**：蓝队 vs 红队，每队1名玩家
- **游戏目标**：在规定时间内将球打进对方球门，得分更高的一方获胜
- **球门机制**：球门会左右移动，增加游戏难度和趣味性

### 游戏流程
1. **准备阶段**：玩家进入场地，系统分配阵营
2. **发球规则**：**球会优先前往落后方所在的位置**
3. **比赛时间**：**单局默认90秒**限时对战，时间结束后统计得分
4. **胜负判定**：得分高的队伍获胜

## 核心机制：三元素系统

### 元素相克关系
游戏采用三元素循环相克机制：

```
冰系 → 火系 → 风系 → 冰系
```

- **冰系** 克制 **风系**
- **火系** 克制 **冰系**
- **风系** 克制 **火系**

### 手势控制
玩家通过VR手势切换护盾元素：

| 手势 | 元素类型 | 效果颜色 |
|------|---------|---------|
| 左手五指前伸 | 风系 | 青色 |
| 右手五指前伸 | 火系 | 红色 |
| 双手交叉 | 冰系 | 蓝色 |

## 护盾元素效果详解

### 冰系护盾（防守型）

**克制关系**：
- ✅ 克制风系球
- ❌ 被火系球克制
- ➖ 对冰系球无效

**效果**：
- 碰到**风系球**：将球转换为冰系，并为自己**额外加分**
- 碰到**火系球**：护盾破碎（仅为表现效果，实际立即刷新），球穿透护盾
- 碰到**冰系球**：无特殊效果，正常反弹

**战术定位**：稳定防守，获取额外分数

---

### 火系护盾（进攻型）

**克制关系**：
- ✅ 克制冰系球
- ❌ 被风系球克制
- ➖ 对火系球无效

**效果**：
- 碰到**冰系球**：将球转换为火系，**第2次碰撞冰球时触发裂变效果（生成裂变火球）**
  - 裂变球：生成额外的小型火系球，增加进攻压力
  - 裂变球会以最小速度向前飞行
  - 裂变球碰到对方球门得分，碰到风系护盾会被消除
- 碰到**风系球**：护盾破碎（仅为表现效果，实际立即刷新），球穿透护盾
- 碰到**火系球**：无特殊效果，正常反弹

**战术定位**：制造裂变球，形成多球进攻

---

### 风系护盾（反击型）

**克制关系**：
- ✅ 克制火系球
- ❌ 被冰系球克制
- ➖ 对风系球无效

**效果**：
- 碰到**火系球**：吸附球并蓄力发射
  - 吸附时长：3秒
  - 发射速度：以最大速度射出，形成强力反击
  - 吸附期间球会跟随护盾移动
- 碰到**冰系球**：护盾破碎（仅为表现效果，实际立即刷新），球穿透护盾
- 碰到**风系球**：无特殊效果，正常反弹
- 碰到**裂变球**：直接消除裂变球

**战术定位**：蓄力反击，清除裂变球

## 得分机制

### 得分方式

1. **进球得分**（主要得分）
   - 球完全进入对方球门区域
   - 为对方阵营加分（即球进入哪方球门，哪方得分）
   - 球门碰撞会增加球速

2. **撞墙得分**（少量得分）
   - 球撞击球门后墙但未完全进入球门
   - 获得少量分数
   - 球速会增加

3. **元素转换加分**（额外得分）
   - 冰系护盾成功转换球的元素时
   - 获得额外分数奖励

### 得分判定
- 系统通过球的位置与球门边界的点积计算判断是否进球
- 球必须在球门的左右边界之间才算进球
- 否则只算撞墙得分

## 物理规则

### 球速控制
- **最小速度**：球有最小速度限制，保证游戏流畅性
- **最大速度**：球有最大速度限制，避免过快难以反应
- **碰撞加速**：球撞击球门区域时会增加速度
- **反弹计算**：根据碰撞角度和速度计算反弹方向

### 强制换边机制
为防止球被困在一侧，设置了强制换边规则：

- **触发条件**：球在同一侧连续碰撞护盾或墙壁达到**6次**
- **效果**：球被强制吹向另一侧
- **计数规则**：
  - 碰撞护盾：计数+1
  - 碰撞普通墙壁：计数+1
  - 碰撞得分墙（球门区域）：计数重置
  - 球自然换边：计数重置
- **方向**：根据球当前所在侧，吹向对侧球门方向

### 发球规则
- 发球位置：场地中央的发球区
- 发球方向：**球会优先前往落后方所在的位置**
- 发球速度：以最小速度发出

## 战术策略

### 防守策略
1. **冰系防守**：稳定防守，转换球的元素并获取额外分数
2. **观察球的元素**：根据来球元素快速切换护盾
3. **预判球路**：提前移动到球的落点

### 进攻策略
1. **火系进攻**：制造裂变球，形成多球进攻压力
2. **风系反击**：吸附蓄力后以最大速度反击
3. **元素组合**：先用火系制造裂变球，再用风系清除对方裂变球

### 高级技巧
1. **元素切换时机**：在球飞行过程中提前切换元素
2. **护盾位置**：利用护盾位置控制球的反弹角度
3. **球门移动预判**：预判球门移动轨迹，瞄准射门
4. **裂变球管理**：及时清除对方裂变球，保护己方球门

## 游戏数据

### 配置参数
- **最大碰撞次数**：6次（触发强制换边）
- **风系吸附时长**：3秒
- **球速范围**：最小速度 ~ 最大速度（具体数值可在预制体中配置）
- **元素切换间隔**：防止频繁切换的冷却时间
- **单局时长**：**默认90秒**

### 战报系统
游戏会记录以下事件：
- 球的元素变化
- 得分事件
- 强制换边事件
- 裂变球生成和消除

## 技术实现

### 客户端-服务端架构
- **服务端**：负责游戏逻辑计算、碰撞检测、得分判定
- **客户端**：负责渲染、特效播放、玩家输入
- **同步机制**：通过Protobuf协议同步游戏状态

### 碰撞层级
游戏使用不同的碰撞层级区分不同元素的球：
- 普通球层（可切换元素）
- 火系球层
- 风系球层
- 冰系球层
- 裂变球层

### 护盾系统
- 每个玩家有一个护盾
- 护盾跟随玩家手部位置移动
- 护盾根据玩家手势切换元素效果
- 不同元素的护盾有不同的碰撞排除层级

## 常见问题

**Q: 为什么我的护盾没有效果？**
A: 检查球的元素是否与护盾元素相克。如果球的元素与护盾相同，不会触发特殊效果。

**Q: 裂变球如何生成？**
A: 使用火系护盾第2次碰撞冰系球时，会触发裂变效果生成裂变球。

**Q: 如何清除裂变球？**
A: 使用风系护盾碰撞裂变球可以直接消除。

**Q: 球为什么会突然改变方向？**
A: 这是强制换边机制，当球在一侧连续碰撞6次后会被强制吹向另一侧。

**Q: 如何获得更高分数？**
A: 除了进球得分，使用冰系护盾转换球的元素可以获得额外加分。

## 更新日志

### 当前版本特色
- 三元素相克系统
- 动态球门移动
- 裂变球机制
- 强制换边机制
- VR手势控制
- 实时得分统计

### 2026-02-12 规则澄清更新
- 发球规则明确：球优先前往落后方位置
- 裂变触发条件：火盾第2次碰撞冰球触发
- 护盾破碎说明：仅为表现效果，立即刷新
- 游戏时长明确：单局默认90秒

---

**游戏开发团队**
LumiSports Project
版本：1.1
